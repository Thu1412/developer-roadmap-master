import{j as t}from"./jsx-runtime.D_zvdyIk.js";import{r}from"./index.DatCARk7.js";import{u as S}from"./use-toast.BdCcSTJE.js";import{g as T,d as P}from"./browser.3c2kCsRM.js";import{g as $}from"./date.DG5KCr4T.js";import{b as C,h as L}from"./http.qJhOBTpO.js";import{i as M}from"./jwt.1xGNZsvU.js";import{s as U}from"./popup.CdCAhVM2.js";import{p as m}from"./page.DyYQD7MX.js";import{M as A}from"./Modal.B1RqXaQs.js";import{G as I}from"./GitHubIcon.NZCYHAdm.js";import{M as k}from"./ModalLoader.BJqnisCv.js";import{V as g,T as E}from"./VoteButton.lLmVgBmX.js";import{A as G}from"./arrow-up-right.DMKR5D6V.js";import{T as V}from"./thumbs-up.CEv1GgFg.js";import"./toast.DlejBBdi.js";import"./index.3whys8t3.js";import"./js.cookie.Cz0CWeBA.js";import"./fp.esm.D_pnqQn4.js";import"./use-outside-click.f1LA7r1K.js";import"./use-keydown.UQ-VttR1.js";import"./classname.y9b8gBZq.js";import"./x.ZVxf9pxD.js";import"./createLucideIcon.uNyFMN5K.js";import"./ErrorIcon.BTBCVae1.js";import"./Spinner.CPY-6wbR.js";function ct(v){const{projectId:j,projectTitle:b,projectDescription:w}=v,{u:l}=T();if(!l)return null;const y=S(),[c,a]=r.useState(!0),[d,p]=r.useState(""),[e,u]=r.useState(),N=async()=>{a(!0),p("");const{response:s,error:o}=await C(`https://api.roadmap.sh/v1-project-solution/${j}/${l}`);if(o||!s){p(o?.message||"Something went wrong"),a(!1);return}u(s),a(!1)},x=async(s,o)=>{if(!M()){U();return}m.set("Submitting vote");const{response:i,error:h}=await L(`https://api.roadmap.sh/v1-vote-project/${s}`,{voteType:o});if(h||!i){y.error(h?.message||"Failed to submit vote"),m.set("");return}m.set(""),u(n=>n&&{...n,upvotes:i?.upvotes||0,downvotes:i?.downvotes||0,voteType:o})};if(r.useEffect(()=>{N().finally()},[]),c||d)return t.jsx(k,{text:"Loading project solution...",isLoading:c,error:d});const f=e?.user.avatar;return t.jsx(A,{onClose:()=>{P("u"),window.location.reload()},wrapperClassName:"max-w-lg",bodyClassName:"h-auto",children:t.jsxs("div",{className:"relative p-6",children:[t.jsx("h1",{className:"mb-1 text-balance text-2xl font-bold text-gray-900",children:b}),t.jsx("p",{className:"text-balance text-sm text-gray-600",children:w}),t.jsx("div",{className:"my-5 rounded-lg bg-gray-100 p-4",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("img",{src:f?`https://dodrc8eu8m09s.cloudfront.net/avatars/${f}`:"/img/default-avatar.png",alt:e?.user?.name,className:"h-12 w-12 rounded-full border-2 border-white shadow-md"}),t.jsxs("div",{children:[t.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:[e?.user.name,"'s Solution"]}),t.jsxs("p",{className:"text-sm text-gray-600",children:["Submitted their solution"," ",$(e?.submittedAt)]})]})]})}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("a",{className:"flex items-center gap-2 rounded-full bg-black px-4 py-2 text-sm font-medium text-white transition-colors hover:bg-gray-800",href:e?.repositoryUrl,target:"_blank",children:[t.jsx(I,{className:"h-5 w-5 text-current"}),"View Solution on GitHub",t.jsx(G,{className:"h-4 w-4"})]}),t.jsxs("div",{className:"flex overflow-hidden rounded-full border",children:[t.jsx(g,{icon:V,isActive:e?.voteType==="upvote",count:e?.upvotes||0,onClick:()=>x(e?.id,"upvote")}),t.jsx(g,{icon:E,isActive:e?.voteType==="downvote",count:e?.downvotes||0,hideCount:!0,onClick:()=>x(e?.id,"downvote")})]})]})]})})}export{ct as ProjectSolutionModal};
