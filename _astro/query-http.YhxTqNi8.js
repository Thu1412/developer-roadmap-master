import{a as h}from"./js.cookie.Cz0CWeBA.js";import{i as d}from"./fp.esm.D_pnqQn4.js";import{T as p,r as u}from"./jwt.1xGNZsvU.js";class o extends Error{status;message;constructor(t,r){super(r),this.status=t,this.message=r}static isFetchError(t){return t instanceof o}}async function c(e,t){const r=e.startsWith("http")?e:`https://api.roadmap.sh${e}`;try{let s="";typeof window<"u"&&(s=(await(await d.load()).get()).visitorId);const i=t?.body instanceof FormData,f=new Headers({Accept:"application/json",Authorization:`Bearer ${h.get(p)}`,...s?{fp:s}:{},...t?.headers??{}});i||f.set("Content-Type","application/json");const a=await fetch(r,{credentials:"include",...t,headers:f}),n=t?.headers?.Accept==="text/html"?await a.text():await a.json();if(n?.status===401)return u(),typeof window<"u"&&(window.location.href="/login"),null;if(!a.ok)throw n.errors?new o(a?.status,n.message):n.message?new o(a?.status,n.message):new Error("An unexpected error occurred");return n}catch(s){throw s}}async function A(e,t,r){return c(e,{...r,method:"POST",body:t instanceof FormData?t:JSON.stringify(t)})}async function P(e,t,r){const s=new URLSearchParams(t).toString(),i=s?`${e}?${s}`:e;return c(i,{credentials:"include",method:"GET",...r})}async function T(e,t){return c(e,{...t,method:"DELETE"})}export{o as F,A as a,T as b,P as h};
