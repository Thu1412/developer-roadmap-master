import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as l}from"./index.DatCARk7.js";import{g as Se}from"./browser.3c2kCsRM.js";import{c as v}from"./classname.y9b8gBZq.js";import{u as F}from"./index.CZrsCZXo.js";import{c as ue,a as $,t as Ce}from"./roadmap.DwTTnFhR.js";import{u as T}from"./use-toast.BdCcSTJE.js";import{b as W,a as re,h as Re,d as Te,c as Ie}from"./http.qJhOBTpO.js";import{g as Fe,i as Y}from"./jwt.1xGNZsvU.js";import{u as pe}from"./use-copy-text.DMdbdIxo.js";import{c as M}from"./createLucideIcon.uNyFMN5K.js";import{C as he}from"./check.DCsIB_xO.js";import{C as xe}from"./copy.IVh-7Rp7.js";import{U as X}from"./users-round.D8gPFCPT.js";import{$ as $e}from"./team.DdD-r4t5.js";import{L as ee}from"./lock.C0iyFeE_.js";import{E as ge,T as Me}from"./TopicDetail.0rOhIF79.js";import{U as fe}from"./users.Dwmw0pd7.js";import{C as Le}from"./circle-check-big.DD4Bg2zr.js";import{T as _e}from"./twitter.CZJTO9_t.js";import{F as De,S as Ue}from"./ShareRoadmapButton.CL5HnPkE.js";import{L as Ae}from"./linkedin.Do1-d-U6.js";import{M as H}from"./Modal.B1RqXaQs.js";import{L as V}from"./loader-circle.1OH4z0ap.js";import{p as Q}from"./page.DyYQD7MX.js";import"./js.cookie.Cz0CWeBA.js";import{a as Z}from"./query-client.BXTfwa3d.js";/* empty css                       */import{u as Ee}from"./use-outside-click.f1LA7r1K.js";import{E as Pe}from"./ellipsis-vertical.CxxBP93e.js";import{S as Oe}from"./square-pen.oIdiM-Bb.js";import{T as ze}from"./trash-2.B2o931ei.js";import{C as We}from"./CreateRoadmapModal.D5FFZedp.js";import{R as qe}from"./RoadmapAlert.DN0qKD_z.js";import{R as z}from"./Rating.DwgkZCtp.js";import{f as Be}from"./number.al1uMBuK.js";import{s as be}from"./popup.CdCAhVM2.js";import{S as je}from"./Spinner.CPY-6wbR.js";import{g as Ye}from"./date.DG5KCr4T.js";import{P as He}from"./Pagination.BKvTuUXh.js";import{S as Ve,F as Ge}from"./server-crash.DmB7c8aI.js";import{M as Ke}from"./message-circle.gi35PKdE.js";import{S as J}from"./star.efkPFH5L.js";import{u as Je}from"./useMutation.BrRqCquH.js";import{a as Qe,h as Ze,F as Xe}from"./query-http.YhxTqNi8.js";import{D as ne}from"./datetime.BHfGb2kO.js";import{S as es}from"./send.CNwPxIps.js";import{F as ss}from"./frown.DuKCWXHf.js";import{E as ts}from"./eye.frvarAt2.js";import{ReadonlyEditor as as}from"./index.BgRaT1MR.js";import{r as rs,u as ns,a as is,b as os}from"./resource-progress.CNHeJjXc.js";import{S as ls}from"./shapes.CzUqgNib.js";import{u as ds}from"./useQuery.BDS8a8wn.js";import"./index.BHh4vvK5.js";import"./index.3whys8t3.js";import"./toast.DlejBBdi.js";import"./fp.esm.D_pnqQn4.js";import"./use-keydown.UQ-VttR1.js";import"./markdown.BXNIcYB9.js";import"./preload-helper.sN6dSm8X.js";import"./GitHubIcon.NZCYHAdm.js";import"./vue.Bx8V6p_T.js";import"./transition.MUZrSsh7.js";import"./dom.B_TnKQIa.js";import"./x.ZVxf9pxD.js";import"./wand-sparkles.DH_Id-ff.js";/* empty css                                 */import"./ai-course.C9pe4RQ2.js";import"./billing.CdvAGjKR.js";import"./AILimitsPopup.IBd1xV7_.js";import"./gift.ZPnr9qou.js";import"./book-open-text.DUZ-qSpq.js";import"./brain.t8-WSjRY.js";import"./chevron-down.C3HM4CLF.js";import"./CodeBlock.DM3RYXoM.js";import"./index.zZad4t7S.js";import"./user-round.BP1hNqEM.js";import"./bot.BOh-sxCh.js";import"./chevron-right.CrKPBoyZ.js";import"./UpgradeAccountModal.Bf1PhEwX.js";import"./UpdatePlanConfirmation.vVGIG51-.js";import"./VerifyUpgrade.DHdhu0dP.js";import"./zap.W9oJWPBR.js";import"./map.D6boQwTM.js";import"./ai.CwFQCDSa.js";import"./file-text.QnmHb0pX.js";import"./heart-handshake.D70r9b2H.js";import"./TwitterIcon.D4xHZP6Y.js";/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cs=[["path",{d:"M8 3 4 7l4 4",key:"9rb6wj"}],["path",{d:"M4 7h16",key:"6tx8e3"}],["path",{d:"m16 21 4-4-4-4",key:"siv7j2"}],["path",{d:"M20 17H4",key:"h6l3hr"}]],ms=M("arrow-left-right",cs);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const us=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],ps=M("circle-help",us);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hs=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"9",x2:"15",y1:"15",y2:"9",key:"1dfufj"}]],xs=M("circle-slash",hs);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gs=[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}],["path",{d:"M15.8 9.2a2.5 2.5 0 0 0-3.5 0l-.3.4-.35-.3a2.42 2.42 0 1 0-3.2 3.6l3.6 3.5 3.6-3.5c1.2-1.2 1.1-2.7.2-3.7",key:"43lnbm"}]],fs=M("message-circle-heart",gs);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bs=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m4.243 5.21 14.39 12.472",key:"1c9a7c"}]],ie=M("shield-ban",bs);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const js=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]],ys=M("smile",js);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ns=[["path",{d:"M2 21a8 8 0 0 1 13.292-6",key:"bjp14o"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"M19 16v6",key:"tddt3s"}],["path",{d:"M22 19h-6",key:"vcuq98"}]],ws=M("user-round-plus",Ns);function ye(i){const{user:s,onClick:t,isSelected:a}=i;return e.jsxs("button",{className:v("relative flex w-full items-center gap-2.5 rounded-lg border p-2.5",a&&"border-gray-500 bg-gray-300 text-black"),onClick:t,children:[e.jsx("img",{src:s.avatar?`https://dodrc8eu8m09s.cloudfront.net/avatars/${s.avatar}`:"/img/default-avatar.png",alt:s.name||"",className:"relative top-[1px] h-10 w-10 shrink-0 rounded-full"}),e.jsxs("div",{className:"inline-grid w-full",children:[e.jsx("h3",{className:"truncate text-left font-semibold",children:s.name}),e.jsx("p",{className:v("truncate text-left text-sm text-gray-500",a&&"text-gray-700"),children:s.email})]})]})}function vs(i){const s=Fe()?.id,{setFriends:t,friends:a,sharedFriendIds:r,setSharedFriendIds:n}=i,c=T(),{isCopied:h,copyText:m}=pe(),[d,f]=l.useState(!0),[j,p]=l.useState(!1);async function o(){if(a.length>0)return;f(!0);const{response:u,error:g}=await W("https://api.roadmap.sh/v1-list-friends");if(g||!u){c.error(g?.message||"Something went wrong");return}t(u.filter(w=>w.status==="accepted"))}l.useEffect(()=>{o().finally(()=>{f(!1)})},[]);const x=d&&e.jsx("ul",{className:"mt-2 grid grid-cols-3 gap-1.5",children:[...Array(3)].map((u,g)=>e.jsxs("li",{className:"flex animate-pulse items-center gap-2.5 rounded-md border p-2",children:[e.jsx("div",{className:"relative top-[1px] h-10 w-10 shrink-0 rounded-full bg-gray-200"}),e.jsxs("div",{className:"inline-grid w-full",children:[e.jsx("div",{className:"h-5 w-2/4 rounded-sm bg-gray-200"}),e.jsx("div",{className:"mt-1 h-5 w-3/4 rounded-sm bg-gray-200"})]})]},g))}),y=`https://roadmap.sh/befriend?u=${s}`;return e.jsxs(e.Fragment,{children:[(a.length>0||d)&&e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("p",{className:"text-sm",children:"Select Friends to share the roadmap with"}),e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"checkbox",checked:r.length===a.length,onChange:u=>{u.target.checked?n(a.map(g=>g.userId)):n([])}}),e.jsx("span",{className:"text-sm",children:"Select all"})]})]}),x,a.length>0&&!d&&e.jsxs(e.Fragment,{children:[e.jsx("ul",{className:"mt-2 grid grid-cols-3 gap-1.5",children:a.map(u=>{const g=r?.includes(u.userId);return e.jsx("li",{children:e.jsx(ye,{user:{name:u.name,avatar:u.avatar,email:u.email},isSelected:g,onClick:()=>{n(g?r.filter(w=>w!==u.userId):[...r,u.userId])}})},u.userId)})}),!j&&e.jsxs("p",{className:"mt-6 text-sm text-gray-600",children:["Don't see a Friend?"," ",e.jsx("button",{onClick:()=>{p(!0)},className:"font-semibold text-gray-900 underline",children:"Add them"})]}),j&&e.jsxs("div",{className:"-mx-4 -mb-4 mt-6 border-t bg-gray-50 px-4 py-4",children:[e.jsxs("p",{className:"mb-1.5 flex items-center gap-1 text-sm text-gray-800",children:[e.jsx(ws,{className:"text-gray-500",size:"20px"}),"Share the link below with your friends to invite them"]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{readOnly:!0,type:"text",value:y,onClick:u=>{u.preventDefault(),u.target.select(),m(y)},className:v("w-full rounded-md border px-2 py-2 text-sm focus:shadow-none focus:outline-0",{"border-green-400 bg-green-50":h})}),e.jsx("button",{onClick:()=>m(y),className:"absolute bottom-0 right-0 top-0 flex items-center px-2.5",children:h?e.jsxs("span",{className:"flex items-center gap-1 text-sm font-medium text-green-600",children:[e.jsx(he,{className:"text-green-600",size:"18px"})," Copied"]}):e.jsx(xe,{className:"text-gray-400",size:"18px"})})]})]})]}),a.length===0&&!d&&e.jsxs("div",{className:"flex h-full grow flex-col items-center justify-center rounded-md border bg-gray-50 text-center",children:[e.jsx(X,{className:"mb-3 h-10 w-10 text-gray-300"}),e.jsxs("p",{className:"font-medium text-gray-500",children:["You do not have any friends yet. ",e.jsx("br",{})," ",e.jsx("a",{target:"_blank",className:"underline underline-offset-2 text-sm",href:"/account/friends",children:"Invite your friends to share roadmaps with."})]})]})]})}function ks(i){const{teams:s,setTeams:t,selectedTeamId:a,setSelectedTeamId:r,isTeamMembersLoading:n,currentTeamId:c,setIsTeamMembersLoading:h,onTeamChange:m}=i,d=T(),[f,j]=l.useState(!0);async function p(){if(s.length>0)return;const{response:x,error:N}=await W("https://api.roadmap.sh/v1-get-user-teams");if(N||!x){d.error(N?.message||"Something went wrong");return}t(x.filter(y=>["admin","manager"].includes(y.role)))}l.useEffect(()=>{p().finally(()=>j(!1))},[]);const o=f&&e.jsx("ul",{className:"mt-2 grid grid-cols-3 gap-1.5",children:[...Array(3)].map((x,N)=>e.jsx("li",{children:e.jsxs("div",{className:"relative flex w-full items-center gap-2 rounded-md border p-2",children:[e.jsx("div",{className:"h-6 w-6 shrink-0 animate-pulse rounded-full bg-gray-200"}),e.jsx("div",{className:"inline-grid w-full",children:e.jsx("div",{className:"h-4 animate-pulse rounded-sm bg-gray-200"})})]})},N))});return e.jsxs(e.Fragment,{children:[(s.length>0||f)&&e.jsx("p",{className:"text-sm",children:"Select a team to transfer this roadmap to"}),o,s.length>0&&!f&&e.jsx("ul",{className:"mt-2 grid grid-cols-3 gap-1.5",children:s.map(x=>{const N=x._id===a;return x._id===c?null:e.jsx("li",{children:e.jsxs("button",{className:v("relative flex w-full items-center gap-2.5 rounded-lg border p-2.5 disabled:cursor-not-allowed disabled:opacity-70",N&&"border-gray-500 bg-gray-100 text-black"),disabled:n,onClick:()=>{r(N?null:x._id),m(x._id)},children:[e.jsx("img",{src:x.avatar?`https://dodrc8eu8m09s.cloudfront.net/avatars/${x.avatar}`:"/img/default-avatar.png",alt:x.name||"",className:"h-6 w-6 shrink-0 rounded-full"}),e.jsx("div",{className:"inline-grid w-full",children:e.jsx("h3",{className:"truncate text-left font-normal",children:x.name})})]})},x._id)})}),s.length===0&&!f&&e.jsxs("div",{className:"flex grow flex-col items-center justify-center gap-2",children:[e.jsx(X,{className:"h-12 w-12 text-gray-500"}),e.jsx("p",{className:"text-gray-500",children:"You are not a member of any team."})]})]})}const Ss=[{id:"me",label:"Only me",long:"Only visible to me",icon:ee},{id:"public",label:"Public",long:"Anyone can view",icon:ge},{id:"friends",label:"Only friends",long:"Only friends can view",icon:fe},{id:"team",label:"Only Members",long:"Visible to team members",icon:X}];function Cs(i){const{isTransferringToTeam:s,setIsTransferringToTeam:t,visibility:a,setVisibility:r,teamId:n,onChange:c}=i,h=F($e),m=d=>{t(!1),r(d),c(d)};return e.jsxs("div",{className:"flex justify-between",children:[e.jsx("ul",{className:"flex w-full items-center gap-1.5",children:Ss.map(d=>{if(d.id==="friends"&&n)return null;const f=!s&&d.id===a;return e.jsx("li",{children:e.jsx(oe,{label:d.label,isActive:f,icon:d.icon,onClick:()=>{m(d.id)}})},d.id)})}),(!n||h.length>1)&&e.jsx("div",{className:"grow",children:e.jsx(oe,{label:"Transfer to team",icon:ms,isActive:s,onClick:()=>{t(!0)},className:'border-red-300 text-red-600 hover:border-red-200 hover:bg-red-50 data-[active="true"]:border-red-600 data-[active="true"]:bg-red-600 data-[active="true"]:text-white'})})]})}function oe(i){const{label:s,isActive:t,onClick:a,icon:r,className:n}=i;return e.jsxs("button",{className:v("flex items-center justify-center gap-2 rounded-md border px-3 py-2 text-sm text-black hover:border-gray-300 hover:bg-gray-100",'data-[active="true"]:border-gray-500 data-[active="true"]:bg-gray-200 data-[active="true"]:text-black',n),"data-active":t,disabled:t,onClick:a,children:[!t&&e.jsx(r,{className:"h-4 w-4"}),t&&e.jsx(he,{className:"h-4 w-4"}),e.jsx("span",{className:"whitespace-nowrap",children:s})]})}function le(i){const{teamId:s,title:t="Select Members",sharedTeamMemberIds:a,setSharedTeamMemberIds:r,membersCache:n,isTeamMembersLoading:c,setIsTeamMembersLoading:h}=i,m=T();async function d(){if(n.has(s))return;h(!0);const{response:p,error:o}=await W(`https://api.roadmap.sh/v1-get-team-member-list/${s}`);if(o||!p){m.error(o?.message||"Something went wrong");return}const x=p?.filter(N=>N.status==="joined")||[];n.set(s,x)}l.useEffect(()=>{d().finally(()=>{h(!1)})},[s]);const f=c&&e.jsx("ul",{className:"mt-2 grid grid-cols-3 gap-2.5",children:[...Array(3)].map((p,o)=>e.jsxs("li",{className:"flex min-h-[66px] animate-pulse items-center gap-2 rounded-md border p-2",children:[e.jsx("div",{className:"h-8 w-8 shrink-0 rounded-full bg-gray-200"}),e.jsxs("div",{className:"inline-grid w-full",children:[e.jsx("div",{className:"h-5 w-2/4 rounded-sm bg-gray-200"}),e.jsx("div",{className:"mt-1 h-5 w-3/4 rounded-sm bg-gray-200"})]})]},o))}),j=n.get(s)||[];return e.jsxs(e.Fragment,{children:[(j.length>0||c)&&e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("p",{className:"text-sm",children:t}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:a.length===j.length,onChange:p=>{p.target.checked?r(j.map(o=>o._id)):r([])}}),e.jsx("span",{className:"text-sm",children:"Select all"})]})]}),f,j?.length>0&&!c&&e.jsx("ul",{className:"mt-2 grid grid-cols-3 gap-2.5",children:j?.map(p=>{const o=a?.includes(p._id?.toString());return e.jsx("li",{children:e.jsx(ye,{user:{name:p.name,avatar:p.avatar,email:p.invitedEmail},isSelected:o,onClick:()=>{r(o?a.filter(x=>x!==p._id?.toString()):[...a,p._id?.toString()])}})},p.userId)})}),j.length===0&&!c&&e.jsxs("div",{className:"flex grow flex-col items-center justify-center gap-2",children:[e.jsx(fe,{className:"h-12 w-12 text-gray-500"}),e.jsx("p",{className:"text-gray-500",children:"No members have been added yet."})]})]})}function Rs(i){const{roadmapSlug:s,roadmapId:t,onClose:a,description:r,visibility:n,isSharingWithOthers:c=!1}=i,h="https://roadmap.sh",m=s?`${h}/r/${s}`:`${h}/r?id=${t}`,{copyText:d,isCopied:f}=pe(),j=[{title:"Twitter",href:`https://twitter.com/intent/tweet?text=${r}&url=${m}`,icon:_e},{title:"Facebook",href:`https://www.facebook.com/sharer/sharer.php?quote=${r}&u=${m}`,icon:De},{title:"Linkedin",href:`https://www.linkedin.com/sharing/share-offsite/?url=${m}`,icon:Ae}],p=`<iframe src="${h}/r/embed?id=${t}" width="100%" height="500px" frameBorder="0"
></iframe>`;return e.jsxs("div",{className:"flex grow flex-col justify-center",children:[e.jsxs("div",{className:"mt-5 flex grow flex-col items-center justify-center gap-1.5",children:[e.jsx(Le,{className:"h-14 w-14 text-green-500"}),c?e.jsx("h3",{className:"text-xl font-medium",children:"Sharing with Others"}):e.jsx("h3",{className:"text-xl font-medium",children:"Sharing Settings Updated"})]}),e.jsx("input",{type:"text",className:"mt-6 w-full rounded-md border bg-gray-50 p-2 px-2.5 text-gray-700 focus:outline-hidden",value:m,readOnly:!0,onClick:o=>{o.currentTarget.select(),d(m)}}),c?e.jsx("p",{className:"mt-1 text-sm text-gray-400",children:"You can share the above link with anyone"}):e.jsx("p",{className:"mt-1 text-sm text-gray-400",children:"You can share the above link with anyone who has access"}),n==="public"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mt-2 border-t pt-2",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"You can also embed this roadmap on your website."}),e.jsx("div",{className:"mt-2",children:e.jsx("input",{onClick:o=>{o.currentTarget.select(),d(p)},readOnly:!0,className:"w-full resize-none rounded-md border bg-gray-50 p-2 text-sm",value:p})})]}),e.jsxs("div",{className:"-mx-4 mt-4 flex items-center gap-1.5",children:[e.jsx("span",{className:"h-px grow bg-gray-300"}),e.jsx("span",{className:"px-2 text-xs uppercase text-gray-400",children:"Or"}),e.jsx("span",{className:"h-px grow bg-gray-300"})]}),e.jsxs("div",{className:"mt-4 flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Share with others on"}),e.jsx("ul",{className:"flex items-center gap-1.5",children:j.map(o=>e.jsx("li",{children:e.jsx("a",{href:o.href,target:"_blank",rel:"noopener noreferrer",className:"flex h-8 w-8 items-center justify-center gap-1.5 rounded-md border bg-gray-50 text-sm text-gray-700 hover:bg-gray-100 focus:outline-hidden",children:e.jsx(o.icon,{className:"h-4 w-4"})})},o.title))})]})]}),e.jsxs("div",{className:"mt-4 flex flex-col items-center justify-end gap-2",children:[e.jsxs("button",{className:v("flex w-full items-center justify-center gap-1.5 rounded-sm bg-black px-4 py-2.5 text-sm font-medium text-white hover:opacity-80",f&&"bg-green-300 text-green-800"),disabled:f,onClick:()=>{d(m)},children:[e.jsx(xe,{className:"h-3.5 w-3.5 stroke-[2.5]"}),f?"Copied":"Copy URL"]}),e.jsx("button",{className:v("flex w-full items-center justify-center gap-1.5 rounded-sm border border-black px-4 py-2 text-sm font-medium hover:bg-gray-100"),onClick:a,children:"Close"})]})]})}function Ne(i){const{roadmapId:s,roadmapSlug:t,onClose:a,isDiscoverable:r=!1,visibility:n,sharedTeamMemberIds:c=[],sharedFriendIds:h=[],teamId:m,onShareSettingsUpdate:d,description:f}=i,j=T(),[p,o]=l.useState(!1),[x,N]=l.useState(!1),[y,u]=l.useState(!1),[g,w]=l.useState([]),[R,S]=l.useState([]),[L,A]=l.useState(!1),q=l.useMemo(()=>new Map,[]),[b,k]=l.useState(n),[I,se]=l.useState(r),[_,D]=l.useState(c),[G,E]=l.useState(h),[P,te]=l.useState(null);let O=!1;(b==="friends"&&G.length===0||x&&!P||b==="team"&&m&&_.length===0)&&(O=!0);const ve=async({sharedFriendIds:C,visibility:U,sharedTeamMemberIds:B})=>{if(o(!0),U==="friends"&&C.length===0){j.error("Please select at least one friend");return}else if(U==="team"&&m&&B.length===0){j.error("Please select at least one member");return}const{response:K,error:ae}=await re(`https://api.roadmap.sh/v1-update-roadmap-visibility/${s}`,{visibility:U,sharedFriendIds:C,sharedTeamMemberIds:B,isDiscoverable:I});if(ae){j.error(ae?.message||"Something went wrong, please try again");return}o(!1),u(!0),d({isDiscoverable:I,sharedFriendIds:C,visibility:U,sharedTeamMemberIds:B})},ke=l.useCallback(async(C,U)=>{if(!s)return;o(!0);const{response:B,error:K}=await re(`https://api.roadmap.sh/v1-transfer-roadmap/${s}`,{teamId:C,sharedTeamMemberIds:U,isDiscoverable:I});if(K){o(!1),j.error(K?.message||"Something went wrong, please try again");return}window.location.reload()},[s]);return y?e.jsx(H,{onClose:a,wrapperClassName:"max-w-lg",bodyClassName:"p-4 flex flex-col",children:e.jsx(Rs,{roadmapSlug:t,visibility:b,roadmapId:s,description:f,onClose:a})}):e.jsxs(H,{onClose:()=>{p||a()},wrapperClassName:"max-w-3xl",bodyClassName:"p-4 flex flex-col min-h-[440px]",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"mb-1 text-xl font-semibold",children:"Update Sharing Settings"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Pick and modify who can access this roadmap."})]}),e.jsx(Cs,{isTransferringToTeam:x,setIsTransferringToTeam:N,visibility:b,setVisibility:k,teamId:m,onChange:C=>{te(null),["me","public"].includes(C)?(D([]),E([])):C==="friends"?E(h.length>0?h:[]):C==="team"&&m?(D(c?.length>0?c:[]),E([])):(E([]),D([])),se(C==="public")}}),e.jsxs("div",{className:"mt-4 flex grow flex-col",children:[!x&&e.jsxs(e.Fragment,{children:[b==="public"&&e.jsxs("div",{className:"flex h-full grow flex-col items-center justify-center rounded-md border bg-gray-50 text-center",children:[e.jsx(ge,{className:"mb-3 h-10 w-10 text-gray-300"}),e.jsx("p",{className:"font-medium text-gray-500",children:"Anyone with the link can access."})]}),b==="me"&&e.jsxs("div",{className:"flex h-full grow flex-col items-center justify-center rounded-md border bg-gray-50 text-center",children:[e.jsx(ee,{className:"mb-3 h-10 w-10 text-gray-300"}),e.jsx("p",{className:"font-medium text-gray-500",children:"Only you will be able to access."})]}),b==="friends"&&e.jsx(vs,{friends:g,setFriends:w,sharedFriendIds:G,setSharedFriendIds:E}),b==="team"&&m&&e.jsx(le,{teamId:m,sharedTeamMemberIds:_,setSharedTeamMemberIds:D,membersCache:q,isTeamMembersLoading:L,setIsTeamMembersLoading:A})]}),x&&e.jsxs(e.Fragment,{children:[e.jsx(ks,{currentTeamId:m,teams:R,setTeams:S,selectedTeamId:P,setSelectedTeamId:te,isTeamMembersLoading:L,setIsTeamMembersLoading:A,onTeamChange:()=>{D([])}}),P&&e.jsxs(e.Fragment,{children:[e.jsx("hr",{className:"-mx-4 my-4"}),e.jsx("div",{className:"mb-4",children:e.jsx(le,{title:"Select who can access this roadmap. You can change this later.",teamId:P,sharedTeamMemberIds:_,setSharedTeamMemberIds:D,membersCache:q,isTeamMembersLoading:L,setIsTeamMembersLoading:A})})]})]})]}),b!=="me"&&e.jsxs(e.Fragment,{children:[e.jsx("hr",{className:"-mx-4 my-4"}),e.jsx("div",{className:"mb-2",children:e.jsx(Ts,{isDiscoverable:I,setIsDiscoverable:se})})]}),e.jsxs("div",{className:"mt-2 flex items-center justify-between gap-1.5",children:[e.jsx("button",{className:"flex items-center justify-center gap-1.5 rounded-md border px-3.5 py-1.5 hover:bg-gray-100 disabled:cursor-not-allowed disabled:opacity-75",disabled:p,onClick:a,children:"Close"}),x&&e.jsxs(de,{disabled:O||p||_.length===0,onClick:()=>{ke(P,_).then(()=>null)},children:[p&&e.jsx(V,{className:"h-4 w-4 animate-spin"}),"Transfer"]}),!x&&e.jsxs(de,{disabled:O||p,onClick:()=>{ve({visibility:b,sharedTeamMemberIds:b==="team"?_:[],sharedFriendIds:b==="friends"?G:[]})},children:[p&&e.jsx(V,{className:"h-4 w-4 animate-spin"}),"Update Sharing Settings"]})]})]})}function de(i){const{onClick:s,disabled:t,children:a,className:r}=i;return e.jsx("button",{className:v("flex min-w-[120px] items-center justify-center gap-1.5 rounded-md border border-gray-900 bg-gray-900 px-4 py-2 text-white hover:bg-gray-800 disabled:cursor-not-allowed disabled:opacity-75",t&&"border-gray-700 bg-gray-700 text-white hover:bg-gray-700",r),disabled:t,onClick:s,children:a})}function Ts(i){const{isDiscoverable:s,setIsDiscoverable:t}=i;return e.jsxs("label",{className:"group flex items-center gap-1.5",children:[e.jsx("input",{type:"checkbox",checked:s,onChange:a=>t(a.target.checked)}),e.jsx("span",{className:"text-sm text-gray-500 group-hover:text-gray-700",children:"Include on discovery page"})]})}function Is(i){const{isSecondaryBanner:s=!1}=i,[t,a]=l.useState(!1),r=F(ue),n=F($);return e.jsxs(e.Fragment,{children:[t&&r&&n&&e.jsx(Ne,{roadmapSlug:n?.slug,isDiscoverable:n.isDiscoverable,description:n?.description,visibility:n?.visibility,teamId:n?.teamId,roadmapId:n?._id,sharedFriendIds:n?.sharedFriendIds||[],sharedTeamMemberIds:n?.sharedTeamMemberIds||[],onClose:()=>a(!1),onShareSettingsUpdate:c=>{$.set({...n,...c})}}),e.jsxs("div",{"data-progress-nums-container":"",className:v("striped-loader relative z-50 hidden items-center justify-between bg-white px-2 py-1.5 sm:flex",{"rounded-bl-md rounded-br-md":s,"rounded-md":!s}),children:[e.jsxs("p",{className:"flex text-sm opacity-0 transition-opacity duration-300","data-progress-nums":"",children:[e.jsxs("span",{className:"mr-2.5 rounded-xs bg-yellow-200 px-1 py-0.5 text-xs font-medium uppercase text-yellow-900",children:[e.jsx("span",{"data-progress-percentage":"",children:"0"}),"% Done"]}),e.jsxs("span",{className:"itesm-center hidden md:flex",children:[e.jsxs("span",{children:[e.jsx("span",{"data-progress-done":"",children:"0"})," completed"]}),e.jsx("span",{className:"mx-1.5 text-gray-400",children:"·"}),e.jsxs("span",{children:[e.jsx("span",{"data-progress-learning":"",children:"0"})," in progress"]}),e.jsx("span",{className:"mx-1.5 text-gray-400",children:"·"}),e.jsxs("span",{children:[e.jsx("span",{"data-progress-skipped":"",children:"0"})," skipped"]}),e.jsx("span",{className:"mx-1.5 text-gray-400",children:"·"}),e.jsxs("span",{children:[e.jsx("span",{"data-progress-total":"",children:"0"})," Total"]})]}),e.jsxs("span",{className:"md:hidden",children:[e.jsx("span",{"data-progress-done":"",children:"0"})," of"," ",e.jsx("span",{"data-progress-total":"",children:"0"})," Done"]})]}),e.jsx("div",{className:"flex items-center gap-3 opacity-0 transition-opacity duration-300","data-progress-nums":"",children:e.jsxs("button",{"data-popup":"progress-help",className:"flex items-center gap-1 text-sm font-medium text-gray-500 opacity-0 transition-opacity hover:text-black","data-progress-nums":"",children:[e.jsx(ps,{className:"h-3.5 w-3.5 stroke-[2.5px]"}),"Track Progress"]})})]}),e.jsx("div",{"data-progress-nums-container":"",className:"striped-loader relative -mb-2 flex items-center justify-between rounded-md border bg-white px-2 py-1.5 text-sm text-gray-700 sm:hidden",children:e.jsxs("span",{"data-progress-nums":"",className:"text-gray-500 opacity-0 transition-opacity duration-300",children:[e.jsx("span",{"data-progress-done":"",children:"0"})," of"," ",e.jsx("span",{"data-progress-total":"",children:"0"})," Done"]})})]})}function Fs(i){const{roadmapTitle:s,roadmapId:t}=i;return e.jsx("div",{className:v("mb-0 mt-4 rounded-md border-0 sm:-mb-[65px] sm:mt-7 sm:border"),children:e.jsx(Is,{isSecondaryBanner:!1,resourceId:t,resourceType:"roadmap"})})}function $s(i){const{onDelete:s,onUpdateSharing:t,onCustomize:a}=i,r=l.useRef(null),[n,c]=l.useState(!1);return Ee(r,()=>{c(!1)}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{disabled:!1,onClick:()=>c(!n),className:"inline-flex items-center justify-center rounded-md border border-gray-300 bg-white py-1.5 pl-2 pr-2 text-xs font-medium text-black hover:border-gray-300 hover:bg-gray-300 sm:pl-1.5 sm:pr-3 sm:text-sm",children:[e.jsx(Pe,{className:"mr-0 h-4 w-4 stroke-[2.5] sm:mr-1.5"}),e.jsx("span",{className:"hidden sm:inline",children:"Actions"})]}),n&&e.jsx("div",{ref:r,className:"align-right absolute right-0 top-full z-9999 mt-1 w-[140px] rounded-md bg-slate-800 px-2 py-2 text-white shadow-md",children:e.jsxs("ul",{children:[a&&e.jsx("li",{children:e.jsxs("button",{onClick:()=>{c(!1),a()},className:"flex w-full cursor-pointer items-center rounded-sm p-2 text-sm font-medium text-slate-100 hover:bg-slate-700",children:[e.jsx(Oe,{size:14,className:"mr-2"}),"Edit"]})}),t&&e.jsx("li",{children:e.jsxs("button",{onClick:()=>{c(!1),t()},className:"flex w-full cursor-pointer items-center rounded-sm p-2 text-sm font-medium text-slate-100 hover:bg-slate-700",children:[e.jsx(ee,{size:14,className:"mr-2"}),"Sharing"]})}),s&&e.jsx("li",{children:e.jsxs("button",{onClick:()=>{c(!1),s()},className:"flex w-full cursor-pointer items-center rounded-sm p-2 text-sm font-medium text-slate-100 hover:bg-slate-700",children:[e.jsx(ze,{size:14,className:"mr-2"}),"Delete"]})})]})})]})}function Ms(){const[i,s]=l.useState(!1);return e.jsxs(e.Fragment,{children:[i&&e.jsx(We,{onClose:()=>{s(!1)}}),e.jsx(qe,{title:"Community Roadmaps",description:e.jsxs(e.Fragment,{children:["This is a custom roadmap made by a community member and is not verified by ",e.jsx("span",{className:"font-semibold",children:"roadmap.sh"})]}),floatingIcon:fs,className:"mb-5 mt-0 sm:-mt-6 sm:mb-7"})]})}function Ls(i){const{ratings:s,canManage:t=!1,roadmapSlug:a}=i,{breakdown:r={},average:n}=s||{},c=n||0,h=[5,4,3,2,1],m=h.reduce((b,k)=>b+r?.[k]||0,0),d=c>0||t,f=T(),[j,p]=l.useState(!0),[o,x]=l.useState(!1),[N,y]=l.useState(!d),[u,g]=l.useState(),[w,R]=l.useState(0),[S,L]=l.useState(""),A=async()=>{if(t){p(!1);return}const{response:b,error:k}=await W(`https://api.roadmap.sh/v1-get-my-roadmap-rating/${a}`);if(!b||k){f.error(k?.message||"Something went wrong"),p(!1);return}g(b?.id),R(b?.rating),L(b?.feedback||""),p(!1)},q=async()=>{if(w<=0){f.error("At least give it a star");return}x(!0);const b=u?"v1-update-custom-roadmap-rating":"v1-rate-custom-roadmap",{response:k,error:I}=await Re(`https://api.roadmap.sh/${b}/${a}`,{rating:w,feedback:S});if(!k||I){f.error(I?.message||"Something went wrong"),x(!1);return}window.location.reload()};return l.useEffect(()=>{if(!Y()||!a){p(!1);return}A().then()},[a]),e.jsxs("div",{className:"flex flex-col gap-3",children:[d&&!N&&e.jsx(e.Fragment,{children:e.jsx("ul",{className:"flex flex-col gap-1 rounded-lg bg-white p-5",children:h.map(b=>{const k=m<=0?0:(r?.[b]||0)/m*100;return e.jsxs("li",{className:"flex items-center gap-2 text-sm",children:[e.jsxs("span",{className:"shrink-0",children:[b," star"]}),e.jsxs("div",{className:"relative h-8 w-full overflow-hidden rounded-md border",children:[e.jsx("div",{className:"h-full bg-yellow-300",style:{width:`${k}%`}}),k>0&&e.jsx("span",{className:"absolute right-3 top-1/2 flex -translate-y-1/2 items-center justify-center text-xs text-black",children:Be(r?.[b]||0)})]}),e.jsxs("span",{className:"w-[35px] shrink-0 text-xs text-gray-500",children:[parseInt(`${k}`,10),"%"]})]},`rating-${b}`)})})}),!t&&!N&&e.jsxs("div",{className:"relative min-h-[100px] rounded-lg bg-white p-4",children:[j&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx(je,{isDualRing:!1,className:"h-5 w-5"})}),!j&&!N&&!u&&e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"mb-2 text-center text-sm font-medium",children:"Rate and share your thoughts with the roadmap creator."}),e.jsx("button",{className:"flex h-10 w-full items-center justify-center rounded-full bg-black p-2.5 text-sm font-medium text-white disabled:opacity-60",onClick:()=>{if(!Y()){be();return}y(!0)},disabled:j,children:j?e.jsx(V,{className:"size-4 animate-spin"}):"Rate Roadmap"})]}),!j&&!N&&u&&e.jsxs("div",{children:[e.jsxs("h3",{className:"mb-2.5 flex items-center justify-between text-base font-semibold",children:["Your Feedback",e.jsx("button",{className:"ml-2 text-sm font-medium text-blue-500 underline underline-offset-2",onClick:()=>{y(!0)},children:"Edit Rating"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{rating:w,starSize:19,readOnly:!0})," (",w,")"]}),S&&e.jsx("p",{className:"mt-2 text-sm",children:S})]})]}),!t&&N&&e.jsxs("div",{className:"rounded-lg bg-white p-5",children:[e.jsx("h3",{className:"font-semibold",children:"Rate this roadmap"}),e.jsx("p",{className:"mt-1 text-sm",children:"Share your thoughts with the roadmap creator."}),e.jsxs("form",{className:"mt-4",onSubmit:b=>{b.preventDefault(),q().then()},children:[e.jsx(z,{rating:w,onRatingChange:b=>{R(b)},starSize:32}),e.jsxs("div",{className:"mt-3 flex flex-col gap-1",children:[e.jsxs("label",{htmlFor:"rating-feedback",className:"block text-sm font-medium",children:["Feedback to Creator"," ",e.jsx("span",{className:"font-normal text-gray-400",children:"(Optional)"})]}),e.jsx("textarea",{id:"rating-feedback",className:"min-h-24 rounded-md border p-2 text-sm outline-hidden focus:border-gray-500",placeholder:"Share your thoughts with the roadmap creator",value:S,onChange:b=>{L(b.target.value)}})]}),e.jsxs("div",{className:v("mt-4 grid grid-cols-2 gap-1"),children:[e.jsx("button",{className:"h-10 w-full rounded-full border p-2.5 text-sm font-medium disabled:opacity-60",onClick:()=>{y(!1)},type:"button",disabled:o,children:"Cancel"}),e.jsx("button",{className:"flex h-10 w-full items-center justify-center rounded-full bg-black p-2.5 text-sm font-medium text-white disabled:opacity-60",type:"submit",disabled:o,children:o?e.jsx(V,{className:"size-4 animate-spin"}):u?"Update Rating":"Submit Rating"})]})]})]})]})}function _s(i){const{roadmapSlug:s,ratings:t}=i,a=Object.keys(t.breakdown||{}).reduce((o,x)=>o+t.breakdown[x],0),r=t.average,[n,c]=l.useState(!0),[h,m]=l.useState(""),[d,f]=l.useState(null),j=async(o=1)=>{c(!0);const{response:x,error:N}=await W(`https://api.roadmap.sh/v1-list-roadmap-ratings/${s}`,{currPage:o});if(!x||N){m(N?.message||"Something went wrong"),c(!1);return}f(x),m(""),c(!1)};if(l.useEffect(()=>{Y()&&j().then()},[]),h)return e.jsxs("div",{className:"flex flex-col items-center justify-center bg-white py-10",children:[e.jsx(Ve,{className:"size-12 text-red-500"}),e.jsx("p",{className:"mt-3 text-lg text-red-500",children:h})]});const p=d?.data||[];return e.jsxs("div",{className:"relative min-h-[100px] overflow-auto rounded-lg bg-white p-2 md:max-h-[550px]",children:[n&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx(je,{isDualRing:!1})}),!n&&p.length>0&&e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"sticky top-1.5 mb-2 flex items-center justify-center gap-1 rounded-lg bg-yellow-50 px-2 py-1.5 text-sm text-yellow-900",children:[e.jsxs("span",{children:["Rated"," ",e.jsx("span",{className:"font-medium",children:r.toFixed(1)})]}),e.jsx(z,{starSize:15,rating:r,readOnly:!0}),"by"," ",e.jsxs("span",{className:"font-medium",children:[a," user",a>1&&"s"]})]}),e.jsx("div",{className:"mb-3 flex flex-col",children:p.map(o=>{const x=o?.avatar?`https://dodrc8eu8m09s.cloudfront.net/avatars/${o.avatar}`:"/img/default-avatar.png",N=p[p.length-1]._id===o._id;return e.jsxs("div",{className:v("px-2 py-2.5",{"border-b":!N}),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("img",{src:x,alt:o.name,className:"h-4 w-4 rounded-full"}),e.jsx("span",{className:"text-sm font-medium",children:o.name})]}),e.jsx("span",{className:"text-xs text-gray-400",children:Ye(o.createdAt)})]}),e.jsxs("div",{className:"mt-2.5",children:[e.jsx(z,{rating:o.rating,readOnly:!0}),o.feedback&&e.jsx("p",{className:"mt-2 text-sm text-gray-500",children:o.feedback})]})]},o._id)})}),e.jsx(He,{variant:"minimal",totalCount:d?.totalCount||1,currPage:d?.currPage||1,totalPages:d?.totalPages||1,perPage:d?.perPage||1,onPageChange:o=>{j(o).then()}})]}),!n&&p.length===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-10",children:[e.jsx(Ke,{className:"size-12 text-gray-200"}),e.jsx("p",{className:"mt-3 text-base text-gray-600",children:"No Feedbacks"})]})]})}function Ds(i){const{onClose:s,ratings:t,roadmapSlug:a,canManage:r=!1}=i,[n,c]=l.useState(r?"feedback":"ratings");return e.jsxs(H,{onClose:s,bodyClassName:"bg-transparent shadow-none",wrapperClassName:"h-auto",overlayClassName:"items-start md:items-center",children:[n==="ratings"&&e.jsx(Ls,{ratings:t,roadmapSlug:a,canManage:r}),n==="feedback"&&e.jsx(_s,{ratings:t,roadmapSlug:a})]})}function Us(i){const{ratings:s,roadmapSlug:t,canManage:a,unseenRatingCount:r}=i,n=s?.average||0,c=Object.keys(s?.breakdown||{}).reduce((d,f)=>d+s?.breakdown[f],0),[h,m]=l.useState(!1);return e.jsxs(e.Fragment,{children:[h&&e.jsx(Ds,{roadmapSlug:t,onClose:()=>{m(!1)},ratings:s,canManage:a}),n===0&&e.jsxs(e.Fragment,{children:[!a&&e.jsxs("button",{className:"flex h-[34px] items-center gap-2 rounded-md border border-gray-300 bg-white py-1 pl-2 pr-3 text-sm font-medium hover:border-black",onClick:()=>{if(!Y()){be();return}m(!0)},children:[e.jsx(J,{className:"size-4 fill-yellow-400 text-yellow-400"}),e.jsx("span",{className:"hidden md:block",children:"Rate this roadmap"}),e.jsx("span",{className:"block md:hidden",children:"Rate"})]}),a&&e.jsxs("span",{className:"flex h-[34px] cursor-default items-center gap-2 rounded-md border border-gray-300 bg-white py-1 pl-2 pr-3 text-sm font-medium opacity-50",children:[e.jsx(J,{className:"size-4 fill-yellow-400 text-yellow-400"}),e.jsx("span",{className:"hidden md:block",children:"No ratings yet"}),e.jsx("span",{className:"block md:hidden",children:"Rate"})]})]}),n>0&&e.jsxs("button",{className:"relative flex h-[34px] items-center gap-2 rounded-md border border-gray-300 bg-white py-1 pl-2 pr-3 text-sm font-medium hover:border-black",onClick:()=>{m(!0)},children:[n.toFixed(1),e.jsx("span",{className:"hidden lg:block",children:e.jsx(z,{starSize:16,rating:n,className:"pointer-events-none gap-px",readOnly:!0})}),e.jsx("span",{className:"lg:hidden",children:e.jsx(J,{className:"size-5 fill-yellow-400 text-yellow-400"})}),"(",c,")",a&&r>0&&e.jsx("span",{className:"absolute right-0 top-0 flex size-4 -translate-y-1/2 translate-x-1/2 items-center justify-center rounded-full bg-red-500 text-[10px] font-medium leading-none text-white",children:r})]})]})}function we(i){const{onClose:s}=i,t=T(),a=F($),r=Je({mutationFn:async()=>Qe(`/v1-submit-for-showcase/${a?._id}`,{}),onSuccess:()=>{Z.invalidateQueries({queryKey:["get-roadmap"]}),s()},onError:d=>{t.error(d?.message||"Something went wrong")}},Z),{showcaseStatus:n,showcaseRejectedReason:c,showcaseRejectedAt:h,updatedAt:m}=a||{};return e.jsx(H,{onClose:s,children:e.jsxs("div",{className:"p-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:n==="rejected_with_reason"?"Rejected with Reason":"Feature Your Roadmap"}),e.jsxs("p",{className:"mt-2 text-sm",children:[n==="rejected_with_reason"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"block rounded-md bg-red-100 px-2 py-1.5 text-red-700",children:c}),e.jsx("span",{className:"block mt-3",children:"Feel free to make changes to your roadmap and resubmit."})]}),!n&&e.jsxs(e.Fragment,{children:["We will review your roadmap and if accepted, we will make it public and show it on the community roadmap listing."," ",e.jsx("span",{className:"mt-4 block font-medium",children:"Are you sure to submit?"})]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-2 gap-2",children:[e.jsx("button",{className:"grow cursor-pointer rounded-lg bg-gray-200 py-2 text-center text-sm hover:bg-gray-300",onClick:s,disabled:r.isPending,children:"Cancel"}),e.jsx("button",{className:"w-full rounded-lg bg-gray-900 py-2 text-sm text-white hover:bg-gray-800 disabled:cursor-not-allowed disabled:opacity-60",disabled:r.isPending,onClick:()=>{const d=m&&ne.fromJSDate(new Date(m)),f=h&&ne.fromJSDate(new Date(h));if(f&&d&&d<f){t.error("You need to make changes to your roadmap before resubmitting.");return}r.mutate()},children:r.isPending?"Submitting...":n==="rejected_with_reason"?"Resubmit":"Submit"})]})]})})}function As(i){const{currentRoadmap:s}=i,{showcaseStatus:t}=s,[a,r]=l.useState(!1);return!s||t||s.aiRoadmapId?null:e.jsxs(e.Fragment,{children:[a&&e.jsx(we,{onClose:()=>{r(!1)}}),e.jsxs("button",{className:"inline-flex items-center justify-center rounded-md border border-gray-300 bg-white py-1.5 pl-2 pr-2 text-xs font-medium text-black hover:border-gray-300 hover:bg-gray-300 sm:pl-1.5 sm:pr-3 sm:text-sm",onClick:()=>{r(!0)},disabled:!!t,children:[e.jsx(es,{className:"mr-0 h-4 w-4 stroke-[2.5] sm:mr-1.5"}),e.jsx("span",{className:"hidden sm:inline",children:"Apply to be Featured"})]})]})}function Es(i){const{currentRoadmap:s}=i,[t,a]=l.useState(!1),{showcaseStatus:r}=s;if(!r)return null;const c={submitted:{icon:ts,label:"We are currently reviewing your roadmap, please wait for our response.",className:"bg-blue-100 text-blue-600 border-blue-200"},approved:{icon:ys,label:"Hooray! Your roadmap is now visible on the community page.",className:"text-green-600 bg-green-100 border-green-300"},rejected:{icon:ss,label:"Sorry, we are unable to feature your roadmap at this time.",className:"text-red-600 bg-red-100 border-red-300"},rejected_with_reason:{icon:Ge,label:e.jsxs(e.Fragment,{children:["Your roadmap could not be featured at this time"," ",e.jsx("button",{className:"font-medium underline underline-offset-2 hover:text-red-800",onClick:()=>{a(!0)},children:"click here to see why"})]}),className:"text-red-800 bg-red-200 border-red-200"}}[r];if(!c)return null;const{icon:h,label:m,className:d}=c;return e.jsxs(e.Fragment,{children:[t&&e.jsx(we,{onClose:()=>{a(!1)}}),e.jsx("div",{className:v("z-10 border-b -mb-4",c.className),children:e.jsx("div",{className:"container relative flex items-center justify-center py-2 text-sm",children:e.jsxs("div",{className:v("flex items-center gap-2",d),children:[e.jsx(h,{className:"h-4 w-4 shrink-0 stroke-[2.5]"}),e.jsx("div",{children:m})]})})})]})}function Ps(i){const s=F(ue),t=F($),{title:a,description:r,_id:n,slug:c,creator:h,team:m,visibility:d,ratings:f,unseenRatingCount:j,showcaseStatus:p}=F($)||{},[o,x]=l.useState(!1),N=T();async function y(){Q.set("Deleting roadmap");const g=t?.teamId,w="https://api.roadmap.sh";let R,S;if(g?{error:R,response:S}=await Te(`${w}/v1-delete-team-resource-config/${g}`,{resourceId:n,resourceType:"roadmap"}):{error:R,response:S}=await Ie(`${w}/v1-delete-roadmap/${n}`),R||!S){N.error(R?.message||"Something went wrong");return}N.success("Roadmap removed"),g?window.location.href=`/team/roadmaps?t=${g}`:window.location.href="/account/roadmaps"}const u=h?.avatar?`https://dodrc8eu8m09s.cloudfront.net/avatars/${h?.avatar}`:"/img/default-avatar.png";return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"relative border-b",children:[t&&s&&e.jsx(Es,{currentRoadmap:t}),e.jsxs("div",{className:"container relative py-5 sm:py-12",children:[!s&&e.jsx(Ms,{}),h?.name&&e.jsxs("div",{className:"-mb-1 flex items-center gap-1.5 text-sm text-gray-500",children:[e.jsx("img",{alt:h.name,src:u,className:"h-5 w-5 rounded-full"}),e.jsxs("span",{children:["Created by ",e.jsx("span",{className:"font-semibold text-gray-900",children:h?.name}),m&&e.jsxs(e.Fragment,{children:[" from ",e.jsx("span",{className:"font-semibold text-gray-900",children:m?.name})]})]})]}),e.jsxs("div",{className:"mb-3 mt-4 sm:mb-4",children:[e.jsx("h1",{className:"text-2xl font-bold sm:mb-2 sm:text-4xl",children:a}),e.jsx("p",{className:"mt-0.5 text-sm text-gray-500 sm:text-lg",children:r})]}),e.jsxs("div",{className:"flex justify-between gap-2 sm:gap-0",children:[e.jsxs("div",{className:"flex justify-stretch gap-1 sm:gap-2",children:[e.jsxs("a",{href:"/community",className:"rounded-md bg-gray-500 px-3 py-1.5 text-xs font-medium text-white hover:bg-gray-600 sm:text-sm","aria-label":"Back to All Roadmaps",children:["←",e.jsx("span",{className:"hidden sm:inline",children:" Discover more"})]}),e.jsx(Ue,{roadmapId:n,description:r,pageUrl:`https://roadmap.sh/r/${c}`,allowEmbed:!0})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[s&&e.jsxs(e.Fragment,{children:[o&&t&&e.jsx(Ne,{roadmapSlug:t?.slug,isDiscoverable:t.isDiscoverable,description:t?.description,visibility:t?.visibility,teamId:t?.teamId,roadmapId:t?._id,sharedFriendIds:t?.sharedFriendIds||[],sharedTeamMemberIds:t?.sharedTeamMemberIds||[],onClose:()=>x(!1),onShareSettingsUpdate:g=>{$.set({...t,...g})}}),t&&e.jsx(As,{currentRoadmap:t}),e.jsx($s,{onUpdateSharing:()=>x(!0),onCustomize:()=>{window.location.href=`https://draw.roadmap.sh/${t?._id}`},onDelete:()=>{window.confirm("Are you sure you want to delete this roadmap?")&&y().finally(()=>null)}})]}),p==="approved"&&e.jsx(Us,{roadmapSlug:c,ratings:f,canManage:s,unseenRatingCount:j||0})]})]}),e.jsx(Fs,{roadmapTitle:a,roadmapId:n})]})]})})}function Os(i){const{error:s}=i;return s.status===404?e.jsx(ce,{icon:e.jsx(ie,{className:"h-16 w-16"}),title:"Roadmap not found",message:"The roadmap you are looking for does not exist or has been deleted."}):e.jsx(ce,{icon:e.jsx(ie,{className:"h-16 w-16"}),title:"Restricted Access",message:s?.message})}function ce(i){const{title:s,message:t,icon:a}=i;return e.jsxs("div",{className:"flex grow flex-col items-center justify-center",children:[a,e.jsx("h2",{className:"mt-4 text-2xl font-semibold",children:s}),e.jsx("p",{children:t||"This roadmap is not available for public access."}),e.jsx("a",{href:"/",className:"mt-4 font-medium underline underline-offset-2 hover:no-underline",children:"← Go back to home"})]})}function zs(i){const{roadmapId:s,canManage:t,className:a}=i,r=`https://draw.roadmap.sh/${s}`;return e.jsx("div",{className:v("flex h-full items-center justify-center",a),children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(xs,{className:"mx-auto h-20 w-20 text-gray-400"}),e.jsx("h3",{className:"mt-2",children:"This roadmap is currently empty."}),t&&e.jsxs("a",{href:r,className:"mt-4 flex items-center rounded-md bg-gray-500 px-4 py-2 font-medium text-white hover:bg-gray-600",children:[e.jsx(ls,{className:"mr-2 inline-block h-4 w-4"}),"Edit Roadmap"]})]})})}function Ws(i){const{roadmap:s,isEmbed:t=!1}=i,a=String(s._id),[r,n]=l.useState(!1),c=l.useRef(null),h=T();async function m(y,u){t||(Q.set("Updating progress"),ns({resourceId:a,resourceType:"roadmap",topicId:y},u).then(()=>{is(y,u)}).catch(g=>{h.error("Something went wrong, please try again."),console.error(g)}).finally(()=>{Q.set(""),os()}))}const d=l.useCallback((y,u)=>{const g=u?.type==="todo"?document.querySelector(`[data-id="${u.id}"]`):y?.currentTarget;if(!g)return;const w=g?.classList.contains("done");m(u.id,w?"pending":"done")},[]),f=l.useCallback((y,u)=>{const g=y?.currentTarget;if(!g)return;const w=g?.classList.contains("learning");m(u.id,w?"pending":"learning")},[]),j=l.useCallback((y,u)=>{const g=y?.currentTarget;if(!g)return;const w=g?.classList.contains("skipped");m(u.id,w?"pending":"skipped")},[]),p=l.useCallback((y,u)=>{y?.currentTarget&&window.dispatchEvent(new CustomEvent("roadmap.node.click",{detail:{topicId:u.id,resourceId:a,resourceType:"roadmap",isCustomResource:!0}}))},[]),o=l.useCallback((y,u)=>{if(!u)return;u.startsWith("http")?window.open(u,"_blank"):window.location.href=u},[]),x=l.useCallback((y,u)=>{const g=y?.currentTarget;if(!g)return;const w=g?.classList.contains("done");m(u,w?"pending":"done")},[]),N=l.useCallback((y,u)=>{const g=y?.currentTarget;if(!g)return;const w=g?.classList.contains("done");m(u,w?"pending":"done")},[]);return e.jsxs(e.Fragment,{children:[r&&e.jsx(zs,{roadmapId:a,canManage:s.canManage||!1,className:"grow"}),e.jsx(as,{ref:c,roadmap:s,className:v(s?.nodes?.length===0?"grow":"min-h-0 max-md:min-h-[1000px]"),onRendered:()=>{rs("roadmap",a).then(()=>{Ce.set(s?.nodes?.filter(y=>["topic","subtopic"].includes(y.type)).length||0),s?.nodes?.length===0&&(n(!0),c?.current?.classList.add("hidden"))})},onTopicClick:p,onTopicRightClick:d,onTopicShiftClick:f,onTopicAltClick:j,onButtonNodeClick:o,onLinkClick:o,onChecklistCheckboxClick:x,onChecklistLableClick:N,fontFamily:"Balsamiq Sans",fontURL:"/fonts/balsamiq.woff2"})]})}function qs(i){const{slug:s,id:t,secret:a}=i;return ds({queryKey:["get-roadmap",{slug:s,id:t}],queryFn:async()=>{try{const r=s?new URL(`https://api.roadmap.sh/v1-get-roadmap-by-slug/${s}`):new URL(`https://api.roadmap.sh/v1-get-roadmap/${t}`);return a&&r.searchParams.set("secret",a),await Ze(r.toString())}catch(r){throw r instanceof SyntaxError?new Xe(404,"Roadmap not found"):r}},retry:!1,enabled:!!(s||t)},Z)}function me(){const i=document.querySelector("[data-roadmap-loader]");i&&i.remove()}function ka(i){const{isEmbed:s=!1,slug:t}=i,{id:a,secret:r}=Se(),[n,c]=l.useState(!0),[h,m]=l.useState(null),{data:d,error:f}=qs({id:a,secret:r,slug:t});return l.useEffect(()=>{d&&(document.title=`${d.title} - roadmap.sh`,m(d),$.set(d),c(!1),me())},[d]),l.useEffect(()=>{f&&(c(!1),me())},[f]),n?null:f?e.jsx(Os,{error:f}):e.jsxs(e.Fragment,{children:[!s&&e.jsx(Ps,{}),e.jsx(Ws,{isEmbed:s,roadmap:h}),e.jsx(Me,{resourceId:h._id,resourceTitle:h.title,resourceType:"roadmap",renderer:"editor",isEmbed:s,canSubmitContribution:!1})]})}export{ka as CustomRoadmap};
