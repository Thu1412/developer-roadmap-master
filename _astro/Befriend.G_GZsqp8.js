import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as x}from"./index.DatCARk7.js";import{b as F,h as R,c as A}from"./http.qJhOBTpO.js";import{p as r}from"./page.DyYQD7MX.js";import{i as L}from"./jwt.1xGNZsvU.js";import{s as $}from"./popup.CdCAhVM2.js";import{g as I}from"./browser.3c2kCsRM.js";import{C as b}from"./CheckIcon.D4OhQ5l1.js";import{u as S}from"./use-toast.BdCcSTJE.js";import{u as q}from"./use-auth.Bw1nhFr_.js";import{E}from"./ErrorIcon.BTBCVae1.js";import"./js.cookie.Cz0CWeBA.js";import"./fp.esm.D_pnqQn4.js";import"./index.3whys8t3.js";import"./toast.DlejBBdi.js";function m(s){const{additionalClasses:o="mr-2 w-[20px] h-[20px]"}=s;return e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",className:`relative ${o}`,stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"9",cy:"7",r:"4"}),e.jsx("line",{x1:"17",x2:"22",y1:"8",y2:"13"}),e.jsx("line",{x1:"22",x2:"17",y1:"8",y2:"13"})]})}function U(s){const{additionalClasses:o="mr-2 w-[20px] h-[20px]"}=s;return e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",className:`relative ${o}`,stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M14 19a6 6 0 0 0-12 0"}),e.jsx("circle",{cx:"8",cy:"9",r:"4"}),e.jsx("polyline",{points:"16 11 18 13 22 9"})]})}function M(s){const{additionalClasses:o="mr-2 w-[20px] h-[20px]"}=s;return e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:`relative ${o}`,children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("path",{d:"m4.9 4.9 14.2 14.2"})]})}function X(){const{u:s}=I(),o=S(),y=q(),[a,i]=x.useState(!1),[v,w]=x.useState(!0),[p,l]=x.useState(""),[t,f]=x.useState(),N=L();async function k(c){const{response:d,error:n}=await F(`https://api.roadmap.sh/v1-get-friend/${c}`);if(n||!d){l(n?.message||"Something went wrong");return}if(d.status==="accepted"){window.location.href="/account/friends?c=fa";return}f(d)}x.useEffect(()=>{s?k(s).finally(()=>{r.set(""),w(!1)}):(w(!1),l("Missing invite ID in URL"),r.set(""))},[s]);async function h(c,d){r.set("Please wait..."),l("");const{response:n,error:u}=await R(`https://api.roadmap.sh/v1-add-friend/${c}`,{});if(u||!n){l(u?.message||"Something went wrong");return}if(n.status==="accepted"){window.location.href="/account/friends?c=fa";return}f(n)}async function g(c,d){r.set("Please wait..."),l("");const{response:n,error:u}=await A(`https://api.roadmap.sh/v1-delete-friend/${c}`,{});if(u||!n){l(u?.message||"Something went wrong");return}f(n),o.success(d)}if(v)return null;if(!t)return e.jsxs("div",{className:"container text-center",children:[e.jsx(E,{additionalClasses:"mx-auto mb-4 mt-24 w-20 opacity-20"}),e.jsx("h2",{className:"mb-1 text-2xl font-bold",children:"Error"}),e.jsx("p",{className:"mb-4 text-base leading-6 text-gray-600",children:p||"There was a problem, please try again."}),e.jsx("div",{children:e.jsx("a",{href:"/",className:"grow cursor-pointer rounded-lg bg-gray-200 px-3 py-2 text-center",children:"Back to home"})})]});const C=t.avatar?`https://dodrc8eu8m09s.cloudfront.net/avatars/${t.avatar}`:"/img/default-avatar.png",j=y?.id===t.id;return e.jsxs("div",{className:"container max-w-[400px]! text-center",children:[e.jsx("img",{alt:"join team",src:C,className:"mx-auto mb-4 mt-24 w-28 rounded-full"}),e.jsx("h2",{className:"mb-1 text-3xl font-bold",children:t.name}),e.jsxs("p",{className:"mb-6 text-base leading-6 text-gray-600",children:["After you add ",t.name," as a friend, you will be able to view each other's skills and progress."]}),e.jsx("div",{className:"mx-auto w-full duration-500 sm:max-w-md",children:e.jsxs("div",{className:"flex w-full flex-col items-center gap-2",children:[t.status==="none"&&e.jsx("button",{disabled:j,onClick:()=>{if(!N)return $();h(t.id).finally(()=>{r.set("")})},type:"button",className:"w-full grow cursor-pointer rounded-lg bg-black px-3 py-2 text-center text-white disabled:cursor-not-allowed disabled:opacity-40",children:j?"You can't add yourself":"Add Friend"}),t.status==="sent"&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"flex w-full grow cursor-default items-center justify-center rounded-lg border  border-gray-300 px-3 py-2 text-center text-black",children:[e.jsx(b,{additionalClasses:"mr-2 h-4 w-4"}),"Request Sent"]}),!a&&e.jsxs("button",{onClick:()=>{i(!0)},type:"button",className:"flex w-full grow cursor-pointer items-center justify-center rounded-lg border border-red-600 bg-red-600 px-3 py-2 text-center text-white hover:bg-red-700",children:[e.jsx(m,{additionalClasses:"mr-2 h-[19px] w-[19px]"}),"Withdraw Request"]}),a&&e.jsxs("span",{className:"flex w-full grow cursor-default items-center justify-center rounded-lg border border-red-600 px-3 py-2.5 text-center text-sm text-red-600",children:["Are you sure?"," ",e.jsx("button",{className:"ml-2 text-red-700 underline",onClick:()=>{g(t.id,"Friend request withdrawn").finally(()=>{r.set("")})},children:"Yes"})," ",e.jsx("button",{onClick:()=>{i(!1)},className:"ml-2 text-red-600 underline",children:"No"})]})]}),t.status==="accepted"&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"flex w-full grow cursor-default items-center justify-center rounded-lg border  border-gray-300 px-3 py-2 text-center text-black",children:[e.jsx(U,{additionalClasses:"mr-2 h-5 w-5"}),"You are friends"]}),!a&&e.jsxs("button",{onClick:()=>{i(!0)},type:"button",className:"flex w-full grow cursor-pointer items-center justify-center rounded-lg border border-red-600 bg-red-600 px-3 py-2 text-center text-white hover:bg-red-700",children:[e.jsx(m,{additionalClasses:"mr-2 h-[19px] w-[19px]"}),"Remove Friend"]}),a&&e.jsxs("span",{className:"flex w-full grow cursor-default items-center justify-center rounded-lg border border-red-600 px-3 py-2.5 text-center text-sm text-red-600",children:["Are you sure?"," ",e.jsx("button",{className:"ml-2 text-red-700 underline",onClick:()=>{g(t.id,"Friend removed").finally(()=>{r.set("")})},children:"Yes"})," ",e.jsx("button",{onClick:()=>{i(!1)},className:"ml-2 text-red-600 underline",children:"No"})]})]}),t.status==="rejected"&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"flex w-full grow cursor-default items-center justify-center rounded-lg border border-gray-300 px-3 py-2 text-center text-black",children:[e.jsx(m,{additionalClasses:"mr-2 h-4 w-4"}),"Request Rejected"]}),e.jsxs("span",{className:"flex w-full grow cursor-default items-center justify-center rounded-lg border border-red-600 px-3 py-2.5 text-center text-sm text-red-600",children:["Changed your mind?"," ",e.jsx("button",{className:"ml-2 text-red-700 underline",onClick:()=>{h(t.id).finally(()=>{r.set("")})},children:"Click here to Accept"})]})]}),t.status==="got_rejected"&&e.jsx(e.Fragment,{children:e.jsxs("span",{className:"flex w-full grow cursor-default items-center justify-center rounded-lg border border-red-500 px-3 py-2 text-center text-red-500",children:[e.jsx(M,{additionalClasses:"mr-2 h-4 w-4"}),"Request Rejected"]})}),t.status==="received"&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>{h(t.id).finally(()=>{r.set("")})},className:"flex w-full grow cursor-pointer items-center justify-center rounded-lg border  border-gray-800 bg-gray-800 px-3 py-2 text-center text-white hover:bg-black",children:[e.jsx(b,{additionalClasses:"mr-2 h-4 w-4"}),"Accept Request"]}),!a&&e.jsxs("button",{onClick:()=>{i(!0)},type:"button",className:"flex w-full grow cursor-pointer items-center justify-center rounded-lg border border-red-600 bg-white px-3 py-2 text-center text-red-600 hover:bg-red-100",children:[e.jsx(m,{additionalClasses:"mr-2 h-[19px] w-[19px]"}),"Reject Request"]}),a&&e.jsxs("span",{className:"flex w-full grow cursor-default items-center justify-center rounded-lg border border-red-600 px-3 py-2.5 text-center text-sm text-red-600",children:["Are you sure?"," ",e.jsx("button",{className:"ml-2 text-red-700 underline",onClick:()=>{g(t.id,"Friend request rejected").finally(()=>{r.set("")})},children:"Yes"})," ",e.jsx("button",{onClick:()=>{i(!1)},className:"ml-2 text-red-600 underline",children:"No"})]})]})]})}),p&&e.jsx("p",{className:"mt-2 rounded-lg bg-red-100 p-2 text-red-700",children:p})]})}export{X as Befriend};
